2025-07-01 23:36:55,611 - IEEECISNormalization - INFO - === Iniciando Normaliza√ß√£o de Features para IEEE-CIS (GNN) ===
2025-07-01 23:36:55,612 - IEEECISNormalization - INFO - Diret√≥rio do script: /graphsentinel_2.0/src/code/ieee-cis/3_feature_engineering
2025-07-01 23:36:55,612 - IEEECISNormalization - INFO - Raiz do projeto: /graphsentinel_2.0
2025-07-01 23:36:55,612 - IEEECISNormalization - INFO - Diret√≥rio de logs: /graphsentinel_2.0/data/statis/ieee-cis
2025-07-01 23:36:55,612 - IEEECISNormalization - INFO - Carregando dados de /graphsentinel_2.0/data/parquet/ieee-cis/ieee-cis-features.parquet
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO - Dataset carregado: (284000, 180)
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO - Taxa de fraude: 0.0362
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO - Total de features a processar: 178
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO - Tipos de features encontradas:
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO -   - Original PCA (V2-V59): 53
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO -   - Card features: 18
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO -   - Address features: 6
2025-07-01 23:36:55,862 - IEEECISNormalization - INFO -   - C features: 11
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO -   - D features: 12
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO -   - M features: 9
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO -   - Email features: 12
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO -   - Temporal features: 7
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO -   - Amount features: 5
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO - --- Analisando Distribui√ß√µes das Features ---
2025-07-01 23:36:55,863 - IEEECISNormalization - INFO - Analisando distribui√ß√µes das features...
2025-07-01 23:36:56,548 - IEEECISNormalization - INFO - original_pca: 25 features
2025-07-01 23:36:56,548 - IEEECISNormalization - INFO -   - Features com alta assimetria: 16
2025-07-01 23:36:56,548 - IEEECISNormalization - INFO -   - Features com muitos outliers: 11
2025-07-01 23:36:56,602 - IEEECISNormalization - INFO - amount_features: 5 features
2025-07-01 23:36:56,602 - IEEECISNormalization - INFO -   - Features com alta assimetria: 1
2025-07-01 23:36:56,602 - IEEECISNormalization - INFO -   - Features com muitos outliers: 1
2025-07-01 23:36:56,642 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: card4
2025-07-01 23:36:56,656 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: card6
2025-07-01 23:36:56,755 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: card1_card2_combined
2025-07-01 23:36:56,755 - IEEECISNormalization - INFO - card_features: 18 features
2025-07-01 23:36:56,755 - IEEECISNormalization - INFO -   - Features com alta assimetria: 7
2025-07-01 23:36:56,755 - IEEECISNormalization - INFO -   - Features com muitos outliers: 3
2025-07-01 23:36:56,811 - IEEECISNormalization - INFO - addr_features: 6 features
2025-07-01 23:36:56,812 - IEEECISNormalization - INFO -   - Features com alta assimetria: 4
2025-07-01 23:36:56,812 - IEEECISNormalization - INFO -   - Features com muitos outliers: 3
2025-07-01 23:36:56,813 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: transaction_timestamp
2025-07-01 23:36:56,846 - IEEECISNormalization - INFO - temporal_engineered: 5 features
2025-07-01 23:36:56,846 - IEEECISNormalization - INFO -   - Features com alta assimetria: 1
2025-07-01 23:36:56,846 - IEEECISNormalization - INFO -   - Features com muitos outliers: 1
2025-07-01 23:36:56,879 - IEEECISNormalization - INFO - statistical_features: 3 features
2025-07-01 23:36:56,879 - IEEECISNormalization - INFO -   - Features com alta assimetria: 1
2025-07-01 23:36:56,879 - IEEECISNormalization - INFO -   - Features com muitos outliers: 1
2025-07-01 23:36:56,882 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M1
2025-07-01 23:36:56,886 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M2
2025-07-01 23:36:56,889 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M3
2025-07-01 23:36:56,893 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M5
2025-07-01 23:36:56,896 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M6
2025-07-01 23:36:56,900 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M7
2025-07-01 23:36:56,904 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M8
2025-07-01 23:36:56,908 - IEEECISNormalization - INFO -   Pulando an√°lise estat√≠stica para coluna categ√≥rica: M9
2025-07-01 23:36:57,304 - IEEECISNormalization - INFO - binary_features: 55 features
2025-07-01 23:36:57,304 - IEEECISNormalization - INFO -   - Features com alta assimetria: 25
2025-07-01 23:36:57,304 - IEEECISNormalization - INFO -   - Features com muitos outliers: 19
2025-07-01 23:36:57,361 - IEEECISNormalization - INFO - clustering_features: 5 features
2025-07-01 23:36:57,362 - IEEECISNormalization - INFO -   - Features com alta assimetria: 4
2025-07-01 23:36:57,362 - IEEECISNormalization - INFO -   - Features com muitos outliers: 4
2025-07-01 23:36:57,422 - IEEECISNormalization - INFO - pca_features: 6 features
2025-07-01 23:36:57,422 - IEEECISNormalization - INFO -   - Features com alta assimetria: 2
2025-07-01 23:36:57,422 - IEEECISNormalization - INFO -   - Features com muitos outliers: 2
2025-07-01 23:36:57,437 - IEEECISNormalization - INFO - anomaly_features: 1 features
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO - magnitude_features: 2 features
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO -   - Features com alta assimetria: 2
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO -   - Features com muitos outliers: 2
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO - --- Executando Normaliza√ß√£o Completa para GNN ---
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO - üîß Iniciando normaliza√ß√£o OTIMIZADA para GNN com standard_clipped scaler...
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO - Total de features a normalizar: 177
2025-07-01 23:36:57,461 - IEEECISNormalization - INFO - Features exclu√≠das: ['TransactionDT', 'isFraud', 'card1']
2025-07-01 23:36:57,940 - IEEECISNormalization - INFO - Preparando features para normaliza√ß√£o...
2025-07-01 23:36:57,940 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: ProductCD
2025-07-01 23:36:57,941 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: card4
2025-07-01 23:36:57,942 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: card6
2025-07-01 23:36:57,943 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: P_emaildomain
2025-07-01 23:36:57,943 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: R_emaildomain
2025-07-01 23:36:57,945 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M1
2025-07-01 23:36:57,945 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M2
2025-07-01 23:36:57,946 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M3
2025-07-01 23:36:57,946 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M4
2025-07-01 23:36:57,947 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M5
2025-07-01 23:36:57,948 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M6
2025-07-01 23:36:57,948 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M7
2025-07-01 23:36:57,949 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M8
2025-07-01 23:36:57,949 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: M9
2025-07-01 23:36:57,952 - IEEECISNormalization - INFO - Convertendo coluna datetime para timestamp: transaction_timestamp
2025-07-01 23:36:57,955 - IEEECISNormalization - INFO - Convertendo coluna categ√≥rica para num√©rica: card1_card2_combined
2025-07-01 23:36:58,192 - IEEECISNormalization - INFO - Convertidas 15 colunas categ√≥ricas para num√©ricas
2025-07-01 23:36:58,192 - IEEECISNormalization - INFO - üö® APLICANDO CLIPPING DE OUTLIERS (98.5% dos dados preservados)
2025-07-01 23:36:58,206 - IEEECISNormalization - INFO -    üîß TransactionAmt: 4237 outliers (1.49%) [0.251, 5543.230] ‚Üí [7.747, 1464.950]
2025-07-01 23:36:59,195 - IEEECISNormalization - INFO -    üîß transaction_timestamp: 4260 outliers (1.50%) [7607464000000000.000, 15811131000000000.000] ‚Üí [7676206790000000.000, 15761238457500000.000]
2025-07-01 23:36:59,223 - IEEECISNormalization - INFO -    üîß amount_log: 4237 outliers (1.49%) [0.224, 8.621] ‚Üí [2.169, 7.290]
2025-07-01 23:36:59,247 - IEEECISNormalization - INFO -    üîß amount_rank: 4237 outliers (1.49%) [0.000, 1.000] ‚Üí [0.007, 0.992]
2025-07-01 23:36:59,557 - IEEECISNormalization - INFO -    üîß dt_per_amt: 4260 outliers (1.50%) [1486.570, 9661922.000] ‚Üí [7684.791, 1398730.500]
2025-07-01 23:36:59,577 - IEEECISNormalization - INFO -    üîß card1_card2_combined: 4244 outliers (1.49%) [0.000, 10578.000] ‚Üí [2.000, 9191.008]
2025-07-01 23:36:59,643 - IEEECISNormalization - INFO -    üîß anomaly_score: 4260 outliers (1.50%) [-0.194, 0.153] ‚Üí [-0.188, 0.060]
2025-07-01 23:36:59,653 - IEEECISNormalization - INFO -    üîß pc_1: 4234 outliers (1.49%) [-22.016, 13.668] ‚Üí [-16.560, 5.256]
2025-07-01 23:36:59,663 - IEEECISNormalization - INFO -    üîß pc_2: 4234 outliers (1.49%) [-14.327, 29.010] ‚Üí [-11.515, 8.377]
2025-07-01 23:36:59,672 - IEEECISNormalization - INFO -    üîß pc_3: 4234 outliers (1.49%) [-11.600, 23.840] ‚Üí [-4.336, 7.825]
2025-07-01 23:36:59,682 - IEEECISNormalization - INFO -    üîß pc_4: 4234 outliers (1.49%) [-2.599, 32.083] ‚Üí [-1.689, 5.699]
2025-07-01 23:36:59,692 - IEEECISNormalization - INFO -    üîß pc_5: 4234 outliers (1.49%) [-32.101, 12.881] ‚Üí [-4.851, 5.381]
2025-07-01 23:36:59,703 - IEEECISNormalization - INFO -    üîß pc_6: 4234 outliers (1.49%) [-7.285, 48.505] ‚Üí [-3.865, 3.467]
2025-07-01 23:36:59,712 - IEEECISNormalization - INFO -    üîß temporal_position: 4260 outliers (1.50%) [0.000, 1.000] ‚Üí [0.008, 0.994]
2025-07-01 23:36:59,735 - IEEECISNormalization - INFO - ‚úì Clipping conclu√≠do: 188,793 outliers em 111 features
2025-07-01 23:36:59,735 - IEEECISNormalization - INFO -    Usando StandardScaler ap√≥s clipping (otimizado para GNN)
2025-07-01 23:36:59,735 - IEEECISNormalization - INFO - Aplicando normaliza√ß√£o...
2025-07-01 23:37:00,851 - IEEECISNormalization - INFO - Verificando resultados da normaliza√ß√£o...
2025-07-01 23:37:00,855 - IEEECISNormalization - INFO -   TransactionAmt: Original: Œº=137.878, œÉ=242.875 ‚Üí Normalizado: Œº=0.000, œÉ=1.000
2025-07-01 23:37:00,857 - IEEECISNormalization - INFO -   ProductCD: Original: categ√≥rica convertida ‚Üí Normalizado: Œº=0.000, œÉ=1.000
2025-07-01 23:37:00,862 - IEEECISNormalization - INFO -   card2: Original: Œº=359.166, œÉ=157.039 ‚Üí Normalizado: Œº=0.000, œÉ=1.000
2025-07-01 23:37:00,866 - IEEECISNormalization - INFO -   card3: Original: Œº=153.117, œÉ=11.185 ‚Üí Normalizado: Œº=-0.000, œÉ=1.000
2025-07-01 23:37:00,868 - IEEECISNormalization - INFO -   card4: Original: categ√≥rica convertida ‚Üí Normalizado: Œº=0.000, œÉ=1.000
2025-07-01 23:37:01,158 - IEEECISNormalization - INFO - Normaliza√ß√£o conclu√≠da com sucesso!
2025-07-01 23:37:01,158 - IEEECISNormalization - INFO - Features normalizadas: 177
2025-07-01 23:37:01,158 - IEEECISNormalization - INFO - Shape final: (284000, 180)
2025-07-01 23:37:01,161 - IEEECISNormalization - INFO - --- Salvando Resultados ---
2025-07-01 23:37:01,161 - IEEECISNormalization - INFO - Salvando dados normalizados...
2025-07-01 23:37:02,350 - IEEECISNormalization - INFO - Dataset normalizado salvo: /graphsentinel_2.0/data/parquet/ieee-cis/ieee-cis-features-normalized.parquet
2025-07-01 23:37:02,351 - IEEECISNormalization - INFO - Scaler salvo: /graphsentinel_2.0/data/parquet/ieee-cis/feature_scaler.pkl
2025-07-01 23:37:02,353 - IEEECISNormalization - INFO - Metadados salvos: /graphsentinel_2.0/data/parquet/ieee-cis/normalization_metadata.json
2025-07-01 23:37:02,353 - IEEECISNormalization - INFO - --- Valida√ß√£o Final da Normaliza√ß√£o ---
2025-07-01 23:37:08,691 - IEEECISNormalization - INFO - ‚úì Valida√ß√£o da normaliza√ß√£o:
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -    - Range global: [-7.143, 10.367]
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -    - M√©dia global: 0.000000
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -    - Desvio padr√£o: 0.968429
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -    - Valores em [-3, +3]: 49,739,774/50,268,000 (98.9%)
2025-07-01 23:37:08,692 - IEEECISNormalization - WARNING - ‚ö†Ô∏è Normaliza√ß√£o pode ter problemas:
2025-07-01 23:37:08,692 - IEEECISNormalization - WARNING -    - Range muito amplo: [-7.143, 10.367]
2025-07-01 23:37:08,692 - IEEECISNormalization - WARNING -    - Muitos outliers: apenas 98.9% em [-3,+3]
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO - === Normaliza√ß√£o de Features Conclu√≠da ===
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO - Resumo da Normaliza√ß√£o:
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -   - Dataset original: (284000, 180)
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -   - Dataset normalizado: (284000, 180)
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -   - Features normalizadas: 177
2025-07-01 23:37:08,692 - IEEECISNormalization - INFO -   - Features exclu√≠das: ['TransactionDT', 'isFraud', 'card1']
2025-07-01 23:37:08,693 - IEEECISNormalization - INFO -   - Scaler utilizado: standard_clipped
2025-07-01 23:37:08,693 - IEEECISNormalization - INFO -   - Arquivo de sa√≠da: /graphsentinel_2.0/data/parquet/ieee-cis/ieee-cis-features-normalized.parquet
2025-07-01 23:37:08,693 - IEEECISNormalization - INFO -   - Scaler salvo em: /graphsentinel_2.0/data/parquet/ieee-cis/feature_scaler.pkl
2025-07-01 23:37:08,693 - IEEECISNormalization - INFO -   - Metadados em: /graphsentinel_2.0/data/parquet/ieee-cis/normalization_metadata.json
